# ============================================
# Security Configuration (REQUIRED)
# ============================================

# Session Secret - CRITICAL SECURITY SETTING
# Generate a secure secret with: openssl rand -hex 32
# NEVER commit the real secret to version control!
SESSION_SECRET=

# HTTPS Enforcement (set to false only for local development)
# In production, this should ALWAYS be true
ENFORCE_HTTPS=true

# Logging Level (info, warn, error, debug)
LOG_LEVEL=info

# Super Admin Emails (comma-separated)
# These emails will have super admin access (requires isSuperAdmin=true in database)
# Example: SUPER_ADMIN_EMAILS=admin@example.com,owner@example.com
# IMPORTANT: Both the email must be in this list AND the account must have isSuperAdmin=true
SUPER_ADMIN_EMAILS=

# ============================================
# Microsoft Azure AD App Registration
# ============================================

CLIENT_ID=your_client_id_here
CLIENT_SECRET=your_client_secret_here
TENANT_ID=your_tenant_id_here
REDIRECT_URI=http://localhost:3000/auth/callback

# Microsoft Entra ID (Azure AD) Integration
# Optional: Set this to override the dynamically constructed redirect URI
# For local: http://localhost:3000/integrations/entra/callback
# For production: https://your-domain.com/integrations/entra/callback
# IMPORTANT: Both URIs must be registered in Azure AD App Registration > Authentication > Redirect URIs
ENTRA_REDIRECT_URI=http://localhost:3000/integrations/entra/callback

# Microsoft Graph Email Notifications
# Used for survey submissions, admin alerts, and email verification
GRAPH_TENANT_ID=<your_graph_tenant_id>
GRAPH_CLIENT_ID=<your_graph_client_id>
GRAPH_CLIENT_SECRET=<your_graph_client_secret>
GRAPH_FROM_EMAIL=alerts@your-domain.com
GRAPH_NOTIFY_EMAILS=admin1@your-domain.com,admin2@your-domain.com

# Base URL for email verification links
# Local: http://localhost:3000
# Production: https://your-domain.com
BASE_URL=http://localhost:3000

# ============================================
# Feature Flags
# ============================================

ENABLE_AZURE_SYNC=false

# ============================================
# Server Configuration
# ============================================

PORT=3000
NODE_ENV=development

# ============================================
# Database Configuration
# ============================================

# Database (PostgreSQL - Railway will auto-inject this in production)
# For local development, use: postgresql://user:password@localhost:5432/subtracker
# For Railway: Railway automatically provides DATABASE_URL
DATABASE_URL=postgresql://localhost:5432/subtracker?schema=public

# ============================================
# Background Sync Configuration
# ============================================

# Set to false to disable automatic background syncing (useful for development)
# Background sync runs every 6 hours to ensure no data loss from Azure's 7-day retention
ENABLE_BACKGROUND_SYNC=true

# ============================================
# OpenAI Configuration (for document extraction)
# ============================================

# OpenAI API key for extracting subscription info from invoices/contracts
# Get your API key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-...

# ============================================
# Email Ingestion Configuration
# ============================================

# Email address to monitor for subscription documents
# Users forward invoices/contracts to this address
SUBSCRIPTION_INBOX_EMAIL=support@yourcompany.com

# How often to poll for new emails (in milliseconds)
# Default: 300000 (5 minutes)
EMAIL_POLLING_INTERVAL_MS=300000

# Enable/disable email ingestion feature
ENABLE_EMAIL_INGESTION=false